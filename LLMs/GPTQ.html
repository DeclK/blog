<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=DeclK><link rel=canonical href=https://declk.github.io/blog/LLMs/GPTQ.html><link rel=prev href=index.html><link rel=next href=../CUDA/index.html><link rel=alternate type=application/rss+xml title="RSS feed" href=../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../feed_rss_updated.xml><link rel=icon href=../img/declk.jpg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.0"><title>GPTQ - DeclK's Blog</title><link rel=stylesheet href=../assets/stylesheets/main.618322db.min.css><link rel=stylesheet href=../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=JetBrains+Mono:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"JetBrains Mono";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css><link rel=stylesheet href=https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css><link rel=stylesheet href=../css/custom.css><link rel=stylesheet href=../css/card.css><link rel=stylesheet href=../css/flink.css><link rel=stylesheet href=../css/tasklist.css><link rel=stylesheet href=../css/footer-stats.css><link rel=stylesheet href=../css/mathjax.css><link rel=stylesheet href=../css/markdown.css><link rel=stylesheet href=../assets/document_dates/fonts/material-icons.css><link rel=stylesheet href=../assets/document_dates/tippy/light.css><link rel=stylesheet href=../assets/document_dates/tippy/material.css><link rel=stylesheet href=../assets/document_dates/tippy/shift-away.css><link rel=stylesheet href=../assets/document_dates/tippy/scale.css><link rel=stylesheet href=../assets/document_dates/tippy/backdrop.css><link rel=stylesheet href=../assets/document_dates/tippy/tippy.css><link rel=stylesheet href=../assets/document_dates/core/core.css><link rel=stylesheet href=../assets/document_dates/user.config.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-NKJWZM1JHX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-NKJWZM1JHX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-NKJWZM1JHX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href=../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#gptq class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Determine classes --> <!-- Header --> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <!-- Link to home --> <a href=/ title="DeclK's Blog" class="md-header__button md-logo" aria-label="DeclK's Blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M23 18H1l7.25-9.67 2 2.67L14 6zm-11.5-5.33L14 16h5l-5-6.67zM5 16h6.5l-3.25-4.33z"></path></svg> </a> <!-- Button to open drawer --> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <!-- Header title --> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> <a href=.. title="DeclK's Blog" aria-label="DeclK's Blog"> DeclK's Blog </a> </span> </div> <div class=md-header__topic> <span class=md-ellipsis> <a href=.. title="DeclK's Blog" aria-label="DeclK's Blog"> DeclK's Blog </a> </span> </div> </div> </div> <!-- About Me link --> <a href=../about.html title="About Me" class=md-source aria-label="About Me" data-md-component=about> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75M8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2"></path></svg> </div> <div class=md-source__repository> </div> </a> <!-- Color palette toggle --> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=indigo aria-label="light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=teal aria-label="dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <!-- User preference: color palette --> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <!-- Site language selector --> <!-- Button to open search modal --> <!-- Check if search is actually enabled - see https://t.ly/DT_0V --> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <!-- Search interface --> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <!-- Repository information --> <div class=md-header__source> <a href=https://github.com/declk/blog/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> Blog GitHub </div> </a> </div> </nav> <!-- Navigation tabs (sticky) --> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../index.html class=md-tabs__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=index.html class=md-tabs__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 16c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2M6 16c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m12 12c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2"></path></svg> LLMs </a> </li> <li class=md-tabs__item> <a href=../CUDA/index.html class=md-tabs__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 16c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2M6 16c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m12 12c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2"></path></svg> CUDA </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=/ title="DeclK's Blog" class="md-nav__button md-logo" aria-label="DeclK's Blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M23 18H1l7.25-9.67 2 2.67L14 6zm-11.5-5.33L14 16h5l-5-6.67zM5 16h6.5l-3.25-4.33z"></path></svg> </a> DeclK's Blog </label> <div class=md-nav__source> <a href=https://github.com/declk/blog/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> Blog GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../index.html class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=index.html class="md-nav__link "> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 16c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2M6 16c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m12 12c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2"></path></svg> <span class=md-ellipsis> LLMs </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> LLMs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> GPTQ </span> <span class="md-nav__icon md-icon"></span> </label> <a href=GPTQ.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> GPTQ </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#obs-obq class=md-nav__link> <span class=md-ellipsis> 前身 OBS &amp; OBQ </span> </a> </li> <li class=md-nav__item> <a href=#gptq_1 class=md-nav__link> <span class=md-ellipsis> GPTQ 算法 </span> </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 实验结果 </span> </a> <nav class=md-nav aria-label=实验结果> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quantizing-small-models class=md-nav__link> <span class=md-ellipsis> Quantizing Small Models </span> </a> </li> <li class=md-nav__item> <a href=#quantizing-big-models class=md-nav__link> <span class=md-ellipsis> Quantizing Big Models </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#math-in-gptq class=md-nav__link> <span class=md-ellipsis> Math in GPTQ </span> </a> <nav class=md-nav aria-label="Math in GPTQ"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lagrange-multiplier class=md-nav__link> <span class=md-ellipsis> Lagrange Multiplier </span> </a> </li> <li class=md-nav__item> <a href=#schur-complement class=md-nav__link> <span class=md-ellipsis> Schur Complement </span> </a> </li> <li class=md-nav__item> <a href=#inverse-ofh_f class=md-nav__link> <span class=md-ellipsis> Inverse of\(H_F\) </span> </a> </li> <li class=md-nav__item> <a href=#cholesky-decomposition class=md-nav__link> <span class=md-ellipsis> Cholesky decomposition </span> </a> </li> <li class=md-nav__item> <a href=#proof-of-gptq-correctness class=md-nav__link> <span class=md-ellipsis> Proof of GPTQ correctness </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 总结 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../CUDA/index.html class="md-nav__link "> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 16c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2M6 16c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m12 12c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2"></path></svg> <span class=md-ellipsis> CUDA </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> CUDA </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#obs-obq class=md-nav__link> <span class=md-ellipsis> 前身 OBS &amp; OBQ </span> </a> </li> <li class=md-nav__item> <a href=#gptq_1 class=md-nav__link> <span class=md-ellipsis> GPTQ 算法 </span> </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 实验结果 </span> </a> <nav class=md-nav aria-label=实验结果> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quantizing-small-models class=md-nav__link> <span class=md-ellipsis> Quantizing Small Models </span> </a> </li> <li class=md-nav__item> <a href=#quantizing-big-models class=md-nav__link> <span class=md-ellipsis> Quantizing Big Models </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#math-in-gptq class=md-nav__link> <span class=md-ellipsis> Math in GPTQ </span> </a> <nav class=md-nav aria-label="Math in GPTQ"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lagrange-multiplier class=md-nav__link> <span class=md-ellipsis> Lagrange Multiplier </span> </a> </li> <li class=md-nav__item> <a href=#schur-complement class=md-nav__link> <span class=md-ellipsis> Schur Complement </span> </a> </li> <li class=md-nav__item> <a href=#inverse-ofh_f class=md-nav__link> <span class=md-ellipsis> Inverse of\(H_F\) </span> </a> </li> <li class=md-nav__item> <a href=#cholesky-decomposition class=md-nav__link> <span class=md-ellipsis> Cholesky decomposition </span> </a> </li> <li class=md-nav__item> <a href=#proof-of-gptq-correctness class=md-nav__link> <span class=md-ellipsis> Proof of GPTQ correctness </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 总结 </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=../index.html class=md-path__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-path__item> <a href=index.html class=md-path__link> <span class=md-ellipsis> LLMs </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id=gptq>GPTQ<a class=headerlink href=#gptq title="Permanent link">¶</a></h1> <div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;"> <p><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"></path></svg></span> 约 4030 个字 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"></path></svg></span> 6 张图片 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"></path></svg></span> 预计阅读时间 20 分钟</p> </div> <div class="document-dates-plugin-wrapper document-dates-top"><div class=document-dates-plugin locale><span data-tippy-content data-tippy-raw=2025-12-04><span class=material-icons data-icon=doc_created></span><time datetime=2025-12-04T21:28:46.976674+08:00>2025-12-04</time></span><span data-tippy-content data-tippy-raw=2025-12-07><span class=material-icons data-icon=doc_updated></span><time datetime=2025-12-07T08:49:07+00:00>2025-12-07</time></span><span class=material-icons data-icon=doc_author></span><div class=avatar-group><div class=avatar-wrapper data-name=DeclK data-tippy-content data-tippy-raw='<a href="mailto:1605224559@qq.com">DeclK</a>'><span class=avatar-text></span><a class=glightbox data-type=image data-width=80% data-height=auto href=https://avatars.githubusercontent.com/declk data-desc-position=bottom><img class=avatar src=https://avatars.githubusercontent.com/declk onerror="this.style.display='none'"></a></div></div></div></div> <ul> <li>论文：<a href=https://arxiv.org/abs/2210.17323>GPTQ: Accurate Post-Training Quantization for Generative Pre-trained Transformers</a></li> <li>论文代码：<a href=https://github.com/IST-DASLab/gptq>https://github.com/IST-DASLab/gptq</a></li> <li>社区代码：<a href=https://github.com/AutoGPTQ/AutoGPTQ>https://github.com/AutoGPTQ/AutoGPTQ</a></li> </ul> <h2 id=obs-obq>前身 OBS &amp; OBQ<a class=headerlink href=#obs-obq title="Permanent link">¶</a></h2> <p>OBS: <a href=https://proceedings.neurips.cc/paper/1992/file/303ed4c69846ab36c2904d3ba8573050-Paper.pdf>Optimal Brain Surgeon</a></p> <p>OBQ: <a href=https://arxiv.org/abs/2208.11580>Optimal Brain Quantization</a></p> <p>OBS 是一种神经网络的裁剪方法，核心思路是：在二阶近似的条件下，寻找一些权重，将这些权重删除后对模型产生的误差最小，其简单的推导过程如下：</p> <p>考虑训练到局部最小误差的网络，对于权重扰动<span class=arithmatex>\(\delta \mathbf w\)</span>​的 Loss 的二阶泰勒展开</p> <div class=arithmatex>\[ \delta E = ( \frac{\partial E}{\partial \mathbf{w}})^T \delta \mathbf{w} + \frac{1}{2} \delta \mathbf{w}^T \mathbf{H} ·\delta \mathbf{w} + O(\|\delta \mathbf{w}\|^3) \]</div> <blockquote> <p><span class=arithmatex>\(E\)</span>就是网络的输出，例如：对于一个线性层来说<span class=arithmatex>\(E=\mathbf{w}·\mathbf{x}\)</span></p> </blockquote> <p>其中<span class=arithmatex>\(\mathbf{H}= \frac{\partial^2 E}{\partial \mathbf{w}^2}\)</span>是网络输出对权重的 Hessian Matrix，基于网络已经收敛到局部最优的假设，泰勒一阶展开应该比较小，所以忽略第一项。并且由于权重扰动较小，所以也忽略更高阶的展开。我们需要获得最小的<span class=arithmatex>\(\delta E\)</span></p> <p>此时对某个权重<span class=arithmatex>\(\mathbf{w}_q\)</span>进行删除的操作表示为</p> <div class=arithmatex>\[ \delta w_q +w_q = 0 \]</div> <p>将上式用向量<span class=arithmatex>\(\mathbf{w}\)</span>表示</p> <div class=arithmatex>\[ \mathbf{e}_q^T·\delta \mathbf{w} + w_q=0 \]</div> <blockquote> <p><span class=arithmatex>\(\mathbf{e}_q\)</span>是权重空间<span class=arithmatex>\(\mathbf{w}\)</span>中对于<span class=arithmatex>\(w_q\)</span>位置的 one-hot 向量</p> </blockquote> <p>基于以上约束，我们可以使用拉格朗日乘数法来解决该最优化问题</p> <div class=arithmatex>\[ L=\frac{1}{2} \delta \mathbf{w}^T· \mathbf{H}· \delta \mathbf{w} + \lambda(\mathbf{e}_q^T·\delta \mathbf{w}+w_q) \]</div> <p>可以解得</p> <div class=arithmatex>\[ \delta\mathbf{w}=-\frac{w_q}{[\mathbf{H}^{-1}]_{qq}}\mathbf{H}^{-1}·\mathbf{e}_q \]</div> <div class=arithmatex>\[ L=\frac{1}{2} \frac{w_q^2}{[\mathbf{H}^{-1}]_{qq}} \]</div> <p>这样我们就得到了一个<span class=arithmatex>\(\delta\mathbf{w}\)</span>使得我们剪切了<span class=arithmatex>\(w_q\)</span>并且调整了其他的权重使得 Loss 的变动最小</p> <p>有了 OBS 的铺垫，OBQ 很快把这种方式推广到了量化当中，<strong>这其实很好理解：常用的量化则是把数值近似到一个接近的值， 而剪枝实际上可以看做把数值直接近似成0（某种意义上或许可以称作1bit或0bit量化）</strong>，可以理解为一种特殊的量化</p> <div class=arithmatex>\[ \mathbf{e}_q^T·\delta \mathbf{w} + w_q= quant(w_q) \]</div> <p>OBQ 将 OBS 扩展后的公式如下：</p> <div class=arithmatex>\[ \delta\mathbf{w}=-\frac{w_q-quant(w_q)}{[\mathbf{H}_F^{-1}]_{q,q}}(\mathbf{H}_F)^{-1}_{:,q} \]</div> <div class=arithmatex>\[ w_q=\arg \min _q \frac{(quant(w_q)-w_q)^2}{[\mathbf{H}_F^{-1}]_{q,q}} \]</div> <blockquote> <p>下标<span class=arithmatex>\(F\)</span>代表当前剩余的所有未量化权重，<span class=arithmatex>\(\mathbf{H}_F\)</span>则为对应的 Hessian Matrix</p> </blockquote> <p>通过不断寻找影响最小的<span class=arithmatex>\(w_q\)</span>进行量化，就能够得到最后的量化模型。在这个过程中我们每量化一个权重<span class=arithmatex>\(w_q\)</span>就要更新当前未量化的权重，并重新计算未量化权重的 Hessian Matrix</p> <h2 id=gptq_1>GPTQ 算法<a class=headerlink href=#gptq_1 title="Permanent link">¶</a></h2> <p>OBQ 算法在量化结果上表现不错，但是太慢了。OBQ 对 ResNet-50 进行量化需要一个小时，但由于其算法复杂度为<span class=arithmatex>\(O(d_{row}·d_{col}^3)\)</span>，在大模型上将花费几年的时间，所以 GPTQ 方法就是在 OBQ 的基础上进行加速，其改进点总结为以下三点：</p> <ol> <li> <p><strong>取消贪心算法</strong></p> <ol> <li>在 OBQ 中，是逐个找影响最小的 q 来剪枝/量化，经过观察发现，其实随机的顺序效果也一样好（甚至在大模型上更好）。原算法对 W 进行优化时，逐行计算，每一行挑选q的顺序都是不一样的。在 GPTQ 中直接全部都采用固定顺序，使得复杂度从<span class=arithmatex>\(O(d_{row}·d_{col}^3)\)</span>下降到<span class=arithmatex>\(O(\max (d_{row}·d_{col}^2, d_{col}^3))\)</span>。<strong>对于一个</strong><span class=arithmatex>\(d_{raw}=d_{col}=1024\)</span><strong>的矩阵来说，复杂度将减少 1000 倍，即 3 个数量级</strong></li> </ol> </li> <li> <p><strong>批处理</strong></p> <p>OBQ 算法在对单个权重量化完成后，会对所有未量化的权重进行更新来进行补偿。这样的方式是具有较低的 compute-memory-ratio 的，尤其是当未量化的权重比较多的情况。由于同一个特征矩阵 W 不同列间的权重更新是不会互相影响的，GPTQ 提出了批处理的方法，一次处理多个列（例如 128 列）。在一个批次内，仍然是逐列地进行量化，但是暂时不更新批次外的未量化权重，在完成列内的量化后，统一更新未量化的权重，这将<strong>大幅提升 compute-memory-ratio</strong></p> <blockquote> <p>Compute-memory-ratio: 程序执行过程中，FLOPs 计算量与在 global memory 获取的数据量之比，单位为 FLOP/Byte，也称作计算强度</p> </blockquote> <p><a class=glightbox data-type=image data-width=80% data-height=auto href=GPTQ/1710324236617-5.png data-desc-position=bottom><img alt=img src=GPTQ/1710324236617-5.png></a></p> </li> <li> <p><strong>数值稳定性</strong></p> <p>在 OBQ 计算<span class=arithmatex>\(\mathbf{H}^{-1}\)</span>的方式是利用 Gaussian elimination 迭代计算的，这样能避免求逆的三次复杂度操作</p> <div class=arithmatex>\[ \mathbf{H}^{-1}_{-q} = (\mathbf{H}^{-1}-\frac{1}{[\mathbf{H}^{-1}]_{q,q}}\mathbf{H}^{-1}_{:,q}\mathbf{H}^{-1}_{q,:})_{-q} \]</div> <blockquote> <p>下标<span class=arithmatex>\(-q\)</span>代表移除矩阵的第<span class=arithmatex>\(q\)</span>行和第<span class=arithmatex>\(q\)</span>列</p> </blockquote> <p>这个过程会产生数值不稳定的问题，对于小模型可以通过在矩阵对角元素上加一个小量<span class=arithmatex>\(\lambda\)</span>来解决，但对于大模型该方法将仍不奏效。得益于每一行都采用相同的量化顺序，所以他们都共享相同的<span class=arithmatex>\(\mathbf{H}^{-1}\)</span>，GPTQ 采用了提前计算好所有需要的信息，避免该迭代过程。计算这些信息的方法使用的是用 Cholesky decomposition 的形式等价原来的计算结果</p> </li> </ol> <p>GPTQ 完整的算法图如下</p> <p><a class=glightbox data-type=image data-width=80% data-height=auto href=GPTQ/1710324236604-1.png data-desc-position=bottom><img alt=img src=GPTQ/1710324236604-1.png></a></p> <h2 id=_1>实验结果<a class=headerlink href=#_1 title="Permanent link">¶</a></h2> <h3 id=quantizing-small-models>Quantizing Small Models<a class=headerlink href=#quantizing-small-models title="Permanent link">¶</a></h3> <p>论文测试了 GPTQ 在 ResNet18 &amp; ResNet50 上的量化效果，可以看到在 4-bit 量化中，GPTQ 几乎和最好的方法打平；在 3-bit 量化中略逊色于最好的方法。在量化时间上 GPTQ 只需要 &lt; 1 min 的时间，而 OBQ 方法则需要 1 小时，这是 GPTQ 的优势</p> <p><a class=glightbox data-type=image data-width=80% data-height=auto href=GPTQ/1710324236604-2.png data-desc-position=bottom><img alt=img src=GPTQ/1710324236604-2.png></a></p> <h3 id=quantizing-big-models>Quantizing Big Models<a class=headerlink href=#quantizing-big-models title="Permanent link">¶</a></h3> <p>GPTQ 算法在量化 1-3B 参数量的模型只需要几十分钟，对于 175B 参数量的模型则需要 3-4 个小时 (on single A100 GPU)</p> <p><a class=glightbox data-type=image data-width=80% data-height=auto href=GPTQ/1710324236604-3.png data-desc-position=bottom><img alt=img src=GPTQ/1710324236604-3.png></a></p> <p>论文使用 RTN 作为 baseline 进行比较，是全面占优的。在越大的模型上，其量化结果越好</p> <p><a class=glightbox data-type=image data-width=80% data-height=auto href=GPTQ/1710324236604-4.png data-desc-position=bottom><img alt=img src=GPTQ/1710324236604-4.png></a></p> <h2 id=math-in-gptq>Math in GPTQ<a class=headerlink href=#math-in-gptq title="Permanent link">¶</a></h2> <h3 id=lagrange-multiplier>Lagrange Multiplier<a class=headerlink href=#lagrange-multiplier title="Permanent link">¶</a></h3> <blockquote> <p>From wiki</p> <p>the <strong>method of Lagrange multipliers</strong> is a strategy for finding the local <a href=https://en.wikipedia.org/wiki/Maxima_and_minima>maxima and minima</a> of a <a href=https://en.wikipedia.org/wiki/Function_(mathematics)>function</a> subject to <a href=https://en.wikipedia.org/wiki/Constraint_(mathematics)>equation constraints</a> </p> </blockquote> <p>其中函数和约束记为</p> <div class=arithmatex>\[ \displaylines{ f(x_1, x_2, \dots, x_n)\\ g(x_1, x_2, \dots, x_n) = 0 } \]</div> <p><a href=https://www.bilibili.com/video/BV15T411f7DY>bilibili</a> 这个视频很好地讲述了拉格朗日乘数法的几何理解：</p> <p>极值点的必要但不充分条件为：1. 满足约束函数条件；2. 原函数梯度与约束的梯度方向相同</p> <div class=arithmatex>\[ \displaylines{ \begin{cases} \nabla f(x_1, x_2, \dots, x_n) = \lambda \nabla g(x_1, x_2, \dots, x_n) \\ g(x_1, x_2, \dots, x_n) = c \end{cases} } \]</div> <p>这两个条件可以用一个 lagrange function 并对其变量求偏导来表示</p> <div class=arithmatex>\[ \displaylines{ \mathcal{L}(x_1, x_2, \dots, x_n, \lambda) = f(x_1, x_2, \dots, x_n) - \lambda (g(x_1, x_2, \dots, x_n) - c) \\ \frac{\partial \mathcal{L}}{\partial x_i} = 0 \quad \text{for } i = 1, \dots, n \quad \text{and} \quad \frac{\partial \mathcal{L}}{\partial \lambda} = 0 } \]</div> <p>利用拉格朗日乘数法就能够轻松推导出 GPTQ 论文中的最优值结论</p> <h3 id=schur-complement>Schur Complement<a class=headerlink href=#schur-complement title="Permanent link">¶</a></h3> <p>舒尔补并没有直接在 GPTQ 的论文当中出现，不过在询问各个 ChatGPT 老师的过程中，schur complement 会频繁出现。这里简单列出其形式和重要特性：</p> <p>对于一个分块矩阵<span class=arithmatex>\(M\)</span>，其中<span class=arithmatex>\(A\)</span>必须是可逆的（如果<span class=arithmatex>\(D\)</span>是可逆的，也可以定义关于<span class=arithmatex>\(D\)</span>的 schur complement）</p> <div class=arithmatex>\[ M = \begin{pmatrix} A &amp; B \\ C &amp; D \end{pmatrix} \]</div> <p>则矩阵<span class=arithmatex>\(M\)</span>关于块<span class=arithmatex>\(A\)</span>的 schur complement 为</p> <div class=arithmatex>\[ S = D - C A^{-1} B \]</div> <p>Schur 补最著名的应用是给出分块矩阵<span class=arithmatex>\(M\)</span>的逆的显式表达式（当<span class=arithmatex>\(A\)</span>和<span class=arithmatex>\(S\)</span>均可逆时）</p> <div class=arithmatex>\[ M^{-1} = \begin{pmatrix} A^{-1} + A^{-1} B S^{-1} C A^{-1} &amp; -A^{-1} B S^{-1} \\ -S^{-1} C A^{-1} &amp; S^{-1} \end{pmatrix} \]</div> <p><strong>为什么重要？</strong> 这个公式将大规模矩阵<span class=arithmatex>\(M\)</span>的求逆问题分解为对较小的子块<span class=arithmatex>\(A\)</span>和<span class=arithmatex>\(S\)</span>的求逆问题，以及一些矩阵乘法。如果<span class=arithmatex>\(A\)</span>和<span class=arithmatex>\(S\)</span>的逆更容易计算（例如，它们是稀疏的、对角化的或已经预先计算好的），这可以<strong>显著降低计算复杂度</strong></p> <h3 id=inverse-ofh_f>Inverse of<span class=arithmatex>\(H_F\)</span><a class=headerlink href=#inverse-ofh_f title="Permanent link">¶</a></h3> <p>在 GPTQ 当中，当我们量化好了某个权重时，就会在 Hessian 矩阵中剔除该权重的位置相关的行和列，然后重新求解子 Hessian 矩阵的逆。在论文当中使用迭代公式求解这个过程</p> <div class=arithmatex>\[ \mathbf{H}^{-1}_{-q} = (\mathbf{H}^{-1}-\frac{1}{[\mathbf{H}^{-1}]_{q,q}}\mathbf{H}^{-1}_{:,q}\mathbf{H}^{-1}_{q,:})_{-q} \]</div> <p>而这个式子，是不是很像上面提到的 schur complement？但实际上二者的联系并没有看上去那样直接。这个证明过程需要使用到 schur complement</p> <blockquote> <p>From DeepSeek（不得不感叹现在的 AI 真的很强，直接把整个证明过程写得非常清楚）</p> <p>将原矩阵进行重新排列</p> <div class=arithmatex>\[ \mathbf{H} = \begin{bmatrix} \mathbf{H}_{-q} &amp; \mathbf{c} \\ \mathbf{d}^\top &amp; e \end{bmatrix} \]</div> <p>其中：</p> <p>-<span class=arithmatex>\(\mathbf{H}_{-q}\)</span>是移除第<span class=arithmatex>\(q\)</span>行和第<span class=arithmatex>\(q\)</span>列后的<span class=arithmatex>\((n-1) \times (n-1)\)</span>子矩阵（即我们要求的逆的部分）。<br> -<span class=arithmatex>\(\mathbf{c}\)</span>是<span class=arithmatex>\(\mathbf{H}\)</span>的第<span class=arithmatex>\(q\)</span>列，但移除第<span class=arithmatex>\(q\)</span>行元素（一个<span class=arithmatex>\((n-1) \times 1\)</span>列向量）。<br> -<span class=arithmatex>\(\mathbf{d}^\top\)</span>是<span class=arithmatex>\(\mathbf{H}\)</span>的第<span class=arithmatex>\(q\)</span>行，但移除第<span class=arithmatex>\(q\)</span>列元素（一个<span class=arithmatex>\(1 \times (n-1)\)</span>行向量）。<br> -<span class=arithmatex>\(e = \mathbf{H}_{q,q}\)</span>是一个标量。</p> <p>根据 schur complement 的定义，我们可以得到<span class=arithmatex>\(H^{-1}\)</span>的表达式</p> <div class=arithmatex>\[ \mathbf{H}^{-1} = \begin{bmatrix} \mathbf{H}_{-q}^{-1} + \frac{1}{\delta} \mathbf{H}_{-q}^{-1} \mathbf{c} \mathbf{d}^\top \mathbf{H}_{-q}^{-1} &amp; -\frac{1}{\delta} \mathbf{H}_{-q}^{-1} \mathbf{c} \\ -\frac{1}{\delta} \mathbf{d}^\top \mathbf{H}_{-q}^{-1} &amp; \frac{1}{\delta} \end{bmatrix} \]</div> <p>其中 schur complement<span class=arithmatex>\(\delta = e - \mathbf{d}^\top \mathbf{H}_{-q}^{-1} \mathbf{c}\)</span></p> <p>由于我们已经事先求得了<span class=arithmatex>\(H^{-1}\)</span>，所以可以根据上述表达式计算得到<span class=arithmatex>\(H_{-q}^{-1}\)</span>。这其中还需要花费一些功夫，我们把<span class=arithmatex>\(H^{-1}\)</span>也进行分块</p> <div class=arithmatex>\[ \mathbf{H}^{-1} = \begin{bmatrix} \mathbf{A} &amp; \mathbf{m} \\ \mathbf{n}^\top &amp; k \end{bmatrix} \]</div> <p>从这个分块形式中，我们可以识别：</p> <p>-<span class=arithmatex>\(\mathbf{H}^{-1}\)</span>的右下角元素是<span class=arithmatex>\([\mathbf{H}^{-1}]_{q,q} = \frac{1}{\delta}\)</span>，因此<span class=arithmatex>\(\delta = \frac{1}{[\mathbf{H}^{-1}]_{q,q}}\)</span><br> -<span class=arithmatex>\(\mathbf{H}^{-1}\)</span>的第<span class=arithmatex>\(q\)</span>列（移除第<span class=arithmatex>\(q\)</span>行元素，可记为<span class=arithmatex>\((\mathbf{H}^{-1}_{:,q})_{-q}\)</span>）是<span class=arithmatex>\(\mathbf{m} = -\frac{1}{\delta} \mathbf{H}_{-q}^{-1} \mathbf{c}\)</span>，<br> -<span class=arithmatex>\(\mathbf{H}^{-1}\)</span>的第<span class=arithmatex>\(q\)</span>行（移除第<span class=arithmatex>\(q\)</span>列元素，可记为<span class=arithmatex>\((\mathbf{H}^{-1}_{q,:})_{-q}\)</span>）是<span class=arithmatex>\(\mathbf{n}^\top = -\frac{1}{\delta} \mathbf{d}^\top \mathbf{H}_{-q}^{-1}\)</span></p> <p>我们需要求解<span class=arithmatex>\(\mathbf{H}_{-q}^{-1}\)</span>，其存在于<span class=arithmatex>\(A\)</span>中，我们已知<span class=arithmatex>\(\mathbf{A} = (\mathbf{H}^{-1})_{-q}\)</span>，所以通过一些简单整理就能够得到<span class=arithmatex>\(\mathbf{H}_{-q}^{-1}\)</span>。我们先把<span class=arithmatex>\(\mathbf{A}\)</span>的式子展开：</p> <div class=arithmatex>\[ \mathbf{A} = (\mathbf{H}^{-1})_{-q} = \mathbf{H}_{-q}^{-1} + \frac{1}{\delta} \mathbf{H}_{-q}^{-1} \mathbf{c} \mathbf{d}^\top \mathbf{H}_{-q}^{-1} \]</div> <p>利用已知的<span class=arithmatex>\(\mathbf{m}\)</span>和<span class=arithmatex>\(\mathbf{n}^\top\)</span>，我们可以计算得到上面的<span class=arithmatex>\(\mathbf{c}, \mathbf{d}^\top\)</span>：</p> <div class=arithmatex>\[ \mathbf{H}_{-q}^{-1} \mathbf{c} = -\delta \mathbf{m}, \quad \mathbf{d}^\top \mathbf{H}_{-q}^{-1} = -\delta \mathbf{n}^\top \]</div> <p>代入表达式：</p> <div class=arithmatex>\[ (\mathbf{H}^{-1})_{-q} = \mathbf{H}_{-q}^{-1} + \frac{1}{\delta} (-\delta \mathbf{m}) (-\delta \mathbf{n}^\top) = \mathbf{H}_{-q}^{-1} + \delta \mathbf{m} \mathbf{n}^\top \]</div> <p>得到</p> <div class=arithmatex>\[ \mathbf{H}_{-q}^{-1} = (\mathbf{H}^{-1})_{-q} - \delta \mathbf{m} \mathbf{n}^\top \]</div> <p>此时所有的量都是已知量，我们把<span class=arithmatex>\(\mathbf{m}, \mathbf{n}^\top, \delta\)</span>，全部换成<span class=arithmatex>\(\mathbf{H}^{-1}\)</span>的表示方式就能得到 GPTQ 中给出的结论了</p> </blockquote> <p>在此过程中，我们对矩阵<span class=arithmatex>\(H\)</span>进行了重新排布，好消息是排布可以使用相似变换来完成，所以不影响以上证明的最终结论</p> <blockquote> <p><strong>移动操作的数学本质</strong></p> <ul> <li>将第<span class=arithmatex>\(q\)</span>行/列移动到边界，等价于用排列矩阵<span class=arithmatex>\(\mathbf{P}\)</span>对<span class=arithmatex>\(\mathbf{H}\)</span>做相似变换：</li> </ul> <p>$$<br> \widetilde{\mathbf{H}} = \mathbf{P} \mathbf{H} \mathbf{P}^\top<br> $$</p> <p>其中<span class=arithmatex>\(\mathbf{P}\)</span>是置换矩阵（<span class=arithmatex>\(\mathbf{P}^{-1} = \mathbf{P}^\top\)</span>）。</p> <p>-<span class=arithmatex>\(\widetilde{\mathbf{H}}\)</span>的逆为：</p> <p>$$<br> \widetilde{\mathbf{H}}^{-1} = \mathbf{P} \mathbf{H}^{-1} \mathbf{P}^\top<br> $$</p> <ul> <li><strong>关键点</strong>：<span class=arithmatex>\(\widetilde{\mathbf{H}}\)</span>的左上角子矩阵<span class=arithmatex>\(\widetilde{\mathbf{H}}_{-n}\)</span>就是原始<span class=arithmatex>\(\mathbf{H}_{-q}\)</span>（仅行列顺序可能不同，但集合相同）。</li> </ul> </blockquote> <h3 id=cholesky-decomposition>Cholesky decomposition<a class=headerlink href=#cholesky-decomposition title="Permanent link">¶</a></h3> <blockquote> <p>From DeepSeek</p> <p>Cholesky 分解是一种非常重要的矩阵分解方法，专门针对<strong>对称正定矩阵</strong>。它将一个对称正定矩阵 <code>A</code> 分解为一个<strong>下三角矩阵</strong> <code>L</code> 和其<strong>转置</strong> <code>Lᵀ</code> 的乘积。</p> <p><strong>数学表达：</strong><br> <code>A = L * Lᵀ</code></p> <p>其中：</p> <ul> <li><code>A</code> 是一个 <code>n x n</code> 的 <strong>对称正定矩阵</strong>。</li> <li><code>L</code> 是一个 <code>n x n</code> 的 <strong>下三角矩阵</strong>（即主对角线以上的元素全为零）。</li> <li><code>Lᵀ</code> 是 <code>L</code> 的 <strong>转置</strong>，是一个上三角矩阵。</li> </ul> <p><strong>为什么重要？优势是什么？</strong></p> <ol> <li><strong>高效性：</strong> 与通用的 LU 分解相比，Cholesky 分解利用了矩阵的对称正定性，<strong>计算量大约只有 LU 分解的一半</strong>，并且<strong>所需的存储空间也更少</strong>（只需要存储 <code>L</code> 矩阵，因为它包含了 <code>Lᵀ</code> 的信息）。这使得它在处理大规模对称正定系统时速度更快、内存占用更低。Cholesky 分解可以通过一种相对直接的算法计算，类似于高斯消元法，但利用了对称性来减少计算量。计算过程<strong>逐行/列</strong>进行</li> <li><strong>数值稳定性：</strong> 对于对称正定矩阵，Cholesky 分解<strong>通常非常数值稳定</strong>，不需要进行主元（pivoting）。正定性保证了在计算过程中不会出现除零错误（因为对角线元素 <code>lⱼⱼ</code> 的计算涉及开平方根，而 <code>aⱼⱼ - Σ...</code> 部分保证是正数）。</li> <li><strong>正定性的检测：</strong> 在计算 Cholesky 分解的过程中，如果遇到试图对负数或零开平方根的情况（即 <code>aⱼⱼ - Σ... &lt;= 0</code>），那么就可以立即断定原始矩阵 <code>A</code> <strong>不是正定</strong>的。因此，Cholesky 分解算法本身也是一个检查矩阵是否正定的有效方法。</li> <li><strong>矩阵求逆：</strong> 虽然直接求逆通常不推荐（效率低且可能引入数值误差），但如果需要对称正定矩阵 <code>A</code> 的逆，可以通过 Cholesky 分解来实现：<ul> <li><code>A = L * Lᵀ</code></li> <li><code>A⁻¹ = (Lᵀ)⁻¹ * L⁻¹</code></li> <li>求三角矩阵的逆比求一般矩阵的逆高效得多。</li> </ul> </li> </ol> </blockquote> <h3 id=proof-of-gptq-correctness>Proof of GPTQ correctness<a class=headerlink href=#proof-of-gptq-correctness title="Permanent link">¶</a></h3> <p>在 GPTQ 算法之中直接使用了 Cholesky 分解过后的上三角矩阵<span class=arithmatex>\(L^T\)</span>来替代<span class=arithmatex>\(\mathbf{H}^{-1}\)</span>，在论文当中完全没证明其正确性，关键证明都是一句带过，所以给我带来很大困扰。事实上需要掌握以上的数学工具才能完全理解该过程</p> <p>要证明 GPTQ 算法的正确性，需要几个额外的关键证明：</p> <ol> <li> <p>证明计算子 Hessian 逆等价于 Cholesky decomposition 子矩阵<span class=arithmatex>\(L_FL_F^T\)</span></p> <div class=arithmatex>\[ \mathbf{H}^{-1}_{-q} = (\mathbf{H}^{-1}-\frac{1}{[\mathbf{H}^{-1}]_{q,q}}\mathbf{H}^{-1}_{:,q}\mathbf{H}^{-1}_{q,:})_{-q}=L_{F}L_F^T \]</div> <p>在 GPTQ 的实际使用过程中<span class=arithmatex>\(q=0\)</span>，即永远按照顺序进行量化，我们就证明在<span class=arithmatex>\(q=0\)</span>的情况下，二者是等价的。我们首先对<span class=arithmatex>\(\mathbf{H}^{-1}\)</span>进行分解</p> <div class=arithmatex>\[ \mathbf{H}^{-1} = L L^T = \begin{bmatrix} l_{11} &amp; 0 \\ l_{21} &amp; L_{22} \end{bmatrix} \begin{bmatrix} l_{11} &amp; l_{21}^T \\ 0 &amp; L_{22}^T \end{bmatrix} = \begin{bmatrix} l_{11}^2 &amp; l_{11} l_{21}^T \\ l_{11} l_{21} &amp; l_{21} l_{21}^T + L_{22} L_{22}^T \end{bmatrix}. \]</div> <p>其中<span class=arithmatex>\(L_{22}\)</span>就是上述提到的<span class=arithmatex>\(L_{F}\)</span>，即剩余的子矩阵，<span class=arithmatex>\(l_{21}\)</span>是一个向量，<span class=arithmatex>\(l_{11}\)</span>是一个标量。根据定义有</p> <p>1.<span class=arithmatex>\([\mathbf{H}^{-1}]_{q,q}=l_{11}^2\)</span><br> 2.<span class=arithmatex>\(\mathbf{H}^{-1}_{q,:}=[l_{11}, l_{21}]\)</span><br> 3.<span class=arithmatex>\(\mathbf{H}^{-1}_{:,q}=[l_{11}, l_{21}]^T\)</span></p> <p>将上述表达式带入到迭代式中既可以求得</p> <div class=arithmatex>\[ \mathbf{H}^{-1}_{-q}== \begin{bmatrix} 0 &amp; 0 \\ 0 &amp; L_{22} L_{22}^T \end{bmatrix}_{-q}=L_{22} L_{22}^T \]</div> </li> <li> <p>证明使用<span class=arithmatex>\(L^T\)</span>替代<span class=arithmatex>\(H^{-1}\)</span>进行计算是等价的</p> <p>这个证明过程也不难，因为在第一行二者只相差一个 scale<span class=arithmatex>\(L_{00}\)</span>，这个差异由一个除法进行了消除。具体来说 GPTQ 是为了计算权重的更新量，该式由之前推导得：</p> <div class=arithmatex>\[ \delta\mathbf{w}=-\frac{w_q-quant(w_q)}{[\mathbf{H}^{-1}]_{q,q}}(\mathbf{H})^{-1}_{:,q} \]</div> <p>由于 GPTQ 是顺序量化，所以这里<span class=arithmatex>\(q \equiv 0\)</span>，易证</p> <div class=arithmatex>\[ \frac{\mathbf{H}^{-1}_{:,0}}{[\mathbf{H}^{-1}]_{0,0}} = \frac{L_{:,0}}{[L]_{0,0}} \]</div> </li> </ol> <p>以上两个证明保证了 GPTQ 算法的正确性：</p> <ol> <li> <p>无需重复计算<span class=arithmatex>\(\mathbf{H}_F^{-1}\)</span>，可以直接使用 Cholesky decomposition 结果</p> </li> <li> <p>无需使用<span class=arithmatex>\(\mathbf{H}^{-1}\)</span>，可直接使用 Cholesky decomposition 的上三角矩阵作为替代</p> </li> </ol> <h2 id=_2>总结<a class=headerlink href=#_2 title="Permanent link">¶</a></h2> <p>GPTQ 解决了大模型<strong>量化的耗时长的问题以及稳定性问题</strong>，在 4-bit 要求下能够保持良好的模型精度，并且对于千亿级别的模型，只需要<strong>几个小时</strong>就能完成量化。在实际使用中，可以先使用 GPTQ 快速地获得一个稳定的基线量化模型，并在此基础上进行精度优化。</p> <script src=https://giscus.app/client.js data-repo=declk/blog-comments data-repo-id=R_kgDOQiTEqg data-category=Announcements data-category-id=DIC_kwDOQiTEqs4CzYFN data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async>
</script> <!-- Synchronize Giscus theme with palette --> <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

        // Instruct Giscus to set theme
        giscus.setAttribute("data-theme", theme)
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function () {
        var ref = document.querySelector("[data-md-component=palette]")
        ref.addEventListener("change", function () {
            var palette = __md_get("__palette")
            if (palette && typeof palette.color === "object") {
                var theme = palette.color.scheme === "slate"
                    ? "transparent_dark"
                    : "light"

                // Instruct Giscus to change theme
                var frame = document.querySelector(".giscus-frame")
                frame.contentWindow.postMessage(
                    {giscus: {setConfig: {theme}}},
                    "https://giscus.app"
                )
            }
        })
    })
</script> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <!-- Application footer --> <footer class=md-footer> <!-- Link to previous and/or next page --> <!-- Website statistics --> <!-- 隐藏运行时间 --> <!-- <div class="md-footer-stats">
    <div class="md-footer-stats__inner md-grid">
      <div class="md-footer-stats__content">
        <span class="md-footer-stats__item">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" style="vertical-align: middle; margin-right: 4px;">
            <path fill="currentColor" d="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z" />
          </svg>
          <span>运行时间: <span id="web-time">加载中...</span></span>
        </span>
      </div>
    </div>
  </div> --> <!-- Further information --> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright © 2025 - Present <a href=https://github.com/declk/ target=_blank rel=noopener>DeclK</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <!-- Social links --> <div class=md-social> <a href=https://github.com/declk/ target=_blank rel=noopener title=GitHub class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> <a href=https://www.zhihu.com/people/DeclK target=_blank rel=noopener title=Zhihu class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M170.5 148.1v217.5h23.4l7.7 26.4 42-26.4h49.5V148.1H170.4zM268.3 342h-27.9l-27.9 17.5-5.1-17.5h-11.9V171.7h72.8zm-118.5-94.3H97.5c1.7-27.1 2.2-51.6 2.2-73.5h51.2s2-22.6-8.6-22.3H53.8c3.5-13.1 7.9-26.7 13.1-40.7 0 0-24.1 0-32.3 21.6-3.4 8.9-13.2 43.1-30.7 78.1 5.9-.6 25.4-1.2 36.8-22.2 2.1-5.9 2.5-6.7 5.1-14.5h28.9c0 10.5-1.2 66.9-1.7 73.4H20.7c-11.7 0-15.6 23.6-15.6 23.6h65.6c-4.4 49.9-28 91.9-70.8 125.1 20.5 5.9 40.9-.9 51-9.9 0 0 23-20.9 35.6-69.3l54 64.9s7.9-26.9-1.2-40c-7.6-8.9-28.1-33.1-36.8-41.8L87.9 312c4.4-14 7-27.6 7.9-40.7h61.6s-.1-23.6-7.6-23.6m412-1.6c20.8-25.6 45-58.6 45-58.6s-18.6-14.8-27.4-4.1c-6 8.2-36.8 48.2-36.8 48.2l19.2 14.4zm-150-59.1c-9-8.2-25.9 2.1-25.9 2.1s39.5 55 41.1 57.4l19.5-13.7s-25.7-37.6-34.7-45.9zM640 258.4c-19.8 0-130.9.9-131.1.9v-101q7.2 0 22.8-1.2c40.9-2.4 70.1-4 87.8-4.8 0 0 12.2-27.2-.6-33.4-3.1-1.2-23.2 4.6-23.2 4.6s-165.2 16.5-232.4 18c1.6 8.8 7.6 17.1 15.8 19.6 13.3 3.5 22.7 1.7 49.2.9 24.8-1.6 43.7-2.4 56.5-2.4v99.8H351.3s2.8 22.3 25.5 22.9h107.9v70.9c0 14-11.2 22-24.5 21.1-14.1.1-26.1-1.1-41.7-1.8 2 4 6.3 14.4 19.3 21.8 9.9 4.8 16.2 6.6 26 6.6 29.6 0 45.7-17.3 44.9-45.3v-73.3h122.4c9.7 0 8.7-23.8 8.7-23.8z"></path></svg> </a> <a href=mailto:1605224559@qq.com target=_blank rel=noopener title="send email to me!" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M536.4-26.3c9.8-3.5 20.6-1 28 6.3s9.8 18.2 6.3 28l-178 496.9c-5 13.9-18.1 23.1-32.8 23.1-14.2 0-27-8.6-32.3-21.7l-64.2-158c-4.5-11-2.5-23.6 5.2-32.6l94.5-112.4c5.1-6.1 4.7-15-.9-20.6s-14.6-6-20.6-.9l-112.4 94.3c-9.1 7.6-21.6 9.6-32.6 5.2L38.1 216.8c-13.1-5.3-21.7-18.1-21.7-32.3 0-14.7 9.2-27.8 23.1-32.8z"></path></svg> </a> </div> </div> </div> </footer> <!-- Website running time counter script --> <script>
  function updateWebTime() {
    var startDate = new Date("2025/12/03 20:00:00");
    var now = new Date();
    var diff = now.getTime() - startDate.getTime();
    
    var days = Math.floor(diff / (1000 * 60 * 60 * 24));
    var hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    var minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
    
    var timeStr = days + " 天 " + hours + " 小时 " + minutes + " 分钟";
    
    var webTimeElement = document.getElementById("web-time");
    if (webTimeElement) {
      webTimeElement.textContent = timeStr;
    }
    
    setTimeout(updateWebTime, 60000); // 每分钟更新一次
  }
  
  // 页面加载完成后启动计时器
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", updateWebTime);
  } else {
    updateWebTime();
  }
  

</script> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "..", "features": ["content.code.annotate", "content.code.copy", "content.code.select", "content.footnote.tooltips", "content.tabs.link", "header.autohide", "navigation.tracking", "navigation.tabs", "navigation.top", "navigation.path", "navigation.indexes", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../assets/javascripts/bundle.e71a0d61.min.js></script> <script src=../js/mathjax_fix.js></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../assets/document_dates/tippy/popper.min.js></script> <script src=../assets/document_dates/tippy/tippy.umd.min.js></script> <script src=../assets/document_dates/core/default.config.js></script> <script src=../assets/document_dates/user.config.js></script> <script src=../assets/document_dates/core/utils.js></script> <script src=../assets/document_dates/core/core.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html><!-- Insert generated snippet here -->